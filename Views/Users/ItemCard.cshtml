@using InventorySystem.Models.DataEntities
@model Item

<script>
    
    $(document).ready(function () {
        
        /*
        $('.card').each(function () {
            $(this).on('click', function () {
                const itemId = $(this).data('item-id');
                ModalShow('dashboard/details/'+itemId);
                
            });
        });
        */
        changeBackground(); 
        changeDisplayName();
        
        
        
    });

    function checkResponse(response){
        if (response.IsValid) {
            if (response.RedirectUrl) {
                RemoveItem(response.RedirectUrl, deleteid);
            }
            else {
                var details = "Route sent by the server missing.";
                ShowError(details);
            }
        }
        else {
            console.log("Response Invalid: ", response);
            ShowError("Response invalid");
        }
    
    }

    function changeDisplayName(){

        $('.catergoryValue').each(function () { 
            
            let categoryVal = $(this);
            let value = categoryVal.text().trim();
            let displayName = categoryVal.siblings('.displayName');  
            switch(value){
                case 'Robots':
                case 'Materials':
                    displayName.text('Code:');
                    break;
                case 'Books':
                    displayName.text('ISBN:');
                    break;
                default:
                    displayName.text('Code:');
                    break;
            }
        });
    }

    function changeBackground() {
        $('.card-status').each(function () {
            var $cardStatus = $(this);
            var status = $cardStatus.text().trim();
            var $displayStatus = $cardStatus.siblings('.display-status');  

            if (!status) {
            status = 'No Status';  
        }

            switch (status) {
                case 'Unknown':
                case 'Poor':
                    $displayStatus.css('background-color', 'gray').text(status);
                    break;
                case 'Complete':
                case 'New':
                    $displayStatus.css('background-color', 'green').text(status);
                    break;
                case 'Good':
                    $displayStatus.css('background-color', 'blue').text(status);
                    break;
                case 'Damaged':
                case 'Defective':
                case 'Missing':
                    $displayStatus.css('background-color', 'red').text(status);
                    break;
                case 'Incomplete(Unusable)':
                case 'Incomplete(Usable)':
                    $displayStatus.css({
                        'background-color': status === 'Incomplete(Usable)' ? 'blue' : 'red'
                    }).text('Incomplete');
                    break;
                default:
                    $displayStatus.css('background-color', 'black').text(status);  
                    break;
            }

 
            $displayStatus.css({
                'color': 'white',
                'border-radius': '12px'
            });
        });
    }

     $('.delete-checkbox ').on('change', function () {
            resetCheckState();
        });
</script>

<div class="card position-relative" data-item-id="@Model.ItemId" data-item-name="@Model.ItemName"
    data-item-code="@Model.ItemCode" data-item-category="@Model.Category" data-item-status="@Model.Status"> 

    <div class="d-none checkboxes-container">
        <input class="delete-checkbox position-absolute mt-2 me-2" type="checkbox" style="top: 0; right: 0;" />
    </div>
    <div class="card-body mt-0">
        <div class="d-flex justify-content-between align-items-center">
            <h6 class="card-title mb-1 fs-6"><strong>@Model.ItemName</strong></h6>
        </div>
        <p class="card-text mb-1">
            <span hidden class="d-none catergoryValue">@Model.Category</span>
            <strong class="displayName"></strong>
            <span class="displayCodeValue">@Model.ItemCode</span/>
        </p>
        <p class="card-text mb-0">
            <span class="card-status d-none">@Model.Status</span>
            <span class="display-status ps-1 pe-1 mb-0"></span>
        </p>

        <a onclick="ModalShow('inventory/details/@Model.ItemId')" 
           class="btn btn-crud btn-sm mt-2 form-control text-light">
           View
        </a>
    </div>
</div>


